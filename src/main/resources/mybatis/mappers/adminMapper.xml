<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- mapper의 namespace와 DAO의 네임스페이스가 일치해야 한다. (다만, DAO에는 경로때문에 뒤에 . 이 붙어있음. -->
<mapper namespace="com.shinhan.heehee.admin">
<!--id는 DAO에서 namespace + "여기" 들어가는 것과 일치해야 한다. -->
<!-- resultType은 SqlMapConfig의 typeAlia 중 alias에 작성해놓은 명칭과 일치하도록 쓴다. -->

	<!-- 회원정보 관리 - 회원정보 관리 - 조회기능 -->
	<select id="wholeUserSearch" resultType="userVO">
		SELECT NAME, ID, EMAIL, PHONE_NUM, ADDRESS, CREATE_DATE 
		FROM HH_USER
		WHERE 1=1
        <if test="category != null and keyword != null and !category.isEmpty() and !keyword.isEmpty()">
            <choose>
                <when test="category == 'memberName'">
                    AND NAME LIKE '%' || #{keyword} || '%'
                </when>
                <when test="category == 'userID'">
                    AND ID LIKE '%' || #{keyword} || '%'
                </when>
                <when test="category == 'email'">
                    AND EMAIL LIKE '%' || #{keyword} || '%'
                </when>
            </choose>
        </if>
        <if test="startDate != null and !startDate.isEmpty()">
            AND CREATE_DATE &gt;= TO_DATE(#{startDate}, 'YYYY-MM-DD')
        </if>
        <if test="endDate != null and !endDate.isEmpty()">
            AND CREATE_DATE &lt;= TO_DATE(#{endDate}, 'YYYY-MM-DD')
        </if>
	</select>
	
	<!-- 회원정보 관리 - 이용상태 관리 - 전체 조회 -->
	<select id="userBanSearch" resultType="userBanVO">
		SELECT hh.NAME, hh.ID, bh.BAN_CONTENT, bh.BAN_STR , bh.BAN_END
		FROM HH_USER hh
		LEFT JOIN BAN_HISTORY bh ON hh.ID = bh.ID
		WHERE 1=1
        <if test="category != null and keyword != null and !category.isEmpty() and !keyword.isEmpty()">
            <choose>
                <when test="category == 'memberName'">
                    AND NAME LIKE '%' || #{keyword} || '%'
                </when>
                <when test="category == 'userID'">
                    AND ID LIKE '%' || #{keyword} || '%'
                </when>
            </choose>
        </if>
        <if test="startDate != null and !startDate.isEmpty()">
            AND CREATE_DATE &gt;= TO_DATE(#{startDate}, 'YYYY-MM-DD')
        </if>
        <if test="endDate != null and !endDate.isEmpty()">
            AND CREATE_DATE &lt;= TO_DATE(#{endDate}, 'YYYY-MM-DD')
        </if>
	</select>
	
	<!-- 회원정보 관리 - 이용상태 관리 - 수정기능 -->
	
	<!-- 여기에 작성 예정
						 -->
	
	<!-- 상품관리 - 일반상품 상세조회 - 조회기능 -->
	<select id="searchProductDetail" resultType="adminProductVO">
		SELECT sp.PRODUCT_SEQ AS PRODUCT_SEQ, 
				pc.CATEGORY AS CATEGORY, 
				pc.DETAIL_CATEGORY AS DETAIL_CATEGORY, 
				sp.ID AS ID, 
				sp.ARTICLE_TITLE AS ARTICLE_TITLE, 
				sp.CREATE_DATE AS CREATE_DATE, 
				sp.PRO_STATUS AS PRO_STATUS
				FROM SELL_PRODUCT sp
				LEFT JOIN PRODUCT_TYPE pt ON sp.SELECT_SEQ = pt.PRODUCT_SEQ
				LEFT JOIN PRODUCT_CATEGORY pc ON pt.PRODUCT_CATE_SEQ = pc.PRODUCT_CATE_SEQ
		WHERE 1=1
		<if test="category != null and keyword != null and !category.isEmpty() and !keyword.isEmpty()">
            <choose>
                <when test="category == 'regNumber'">
                    AND sp.PRODUCT_SEQ = #{keyword}
                </when>
                <when test="category == 'category'">
                    AND pc.CATEGORY LIKE '%' || #{keyword} || '%'
                </when>
                <when test="category == 'subCategory'">
                    AND pc.DETAIL_CATEGORY LIKE '%' || #{keyword} || '%'
                </when>
                <when test="category == 'sellerID'">
                    AND sp.ID LIKE '%' || #{keyword} || '%'
                </when>
                <when test="category == 'status'">
                    AND sp.PRO_STATUS LIKE '%' || #{keyword} || '%'
                </when>
            </choose>
        </if>
		ORDER BY sp.PRODUCT_SEQ ASC
	</select>
	
	<!-- 상품관리 - 일반상품 상세조회 - 수정기능 -->
	
	<!-- 여기에 작성 예정
						 -->
	
	<!-- 상품관리 - 일반상품 상세조회 - 삭제기능 -->
	
	<!-- 여기에 작성 예정
						 -->
	
	<!-- 상품관리 - 경매상품 상세조회 - 조회기능 -->
	<select id="searchAuctionDetail" resultType="adminAuctionVO">
		SELECT ap.PRODUCT_SEQ AS PRODUCT_SEQ,
				pc.CATEGORY AS CATEGORY,
				pc.DETAIL_CATEGORY AS DETAIL_CATEGORY,
				ap.SELLER_ID AS SELLER_ID,
				ap.AUCTION_TITLE AS AUCTION_TITLE,
				ap.EXP_TIME AS EXP_TIME,
				ap.AUC_STATUS AS AUC_STATUS
				FROM AUC_PRODUCT ap 
				LEFT JOIN PRODUCT_CATEGORY pc ON ap.AUCTION_SEQ = pc.PRODUCT_CATE_SEQ
		WHERE 1=1
		<if test="category != null and keyword != null and !category.isEmpty() and !keyword.isEmpty()">
            <choose>
                <when test="category == 'regNumber'">
                    AND ap.PRODUCT_SEQ = #{keyword}
                </when>
                <when test="category == 'category'">
                    AND pc.CATEGORY LIKE '%' || #{keyword} || '%'
                </when>
                <when test="category == 'subCategory'">
                    AND pc.DETAIL_CATEGORY LIKE '%' || #{keyword} || '%'
                </when>
                <when test="category == 'sellerID'">
                    AND ap.SELLER_ID LIKE '%' || #{keyword} || '%'
                </when>
                <when test="category == 'status'">
                    AND ap.AUC_STATUS LIKE '%' || #{keyword} || '%'
                </when>
            </choose>
        </if>
		ORDER BY ap.PRODUCT_SEQ ASC
	</select>
	
	<!-- 상품관리 - 경매상품 상세조회 - 수정기능 -->
	
	<!-- 여기에 작성 예정
						 -->
	
	<!-- 상품관리 - 경매상품 상세조회 - 삭제기능 -->
	
	<!-- 여기에 작성 예정
						 -->
						 
	<!-- 상품관리 - 카테고리 관리 - 조회기능 -->
	<select id="searchCategoryInfo" resultType="adminCategoryVO">
		SELECT pc.PRODUCT_CATE_SEQ AS PRODUCT_CATE_SEQ , pc.CATEGORY AS CATEGORY , pc.DETAIL_CATEGORY AS DETAIL_CATEGORY 
		FROM PRODUCT_CATEGORY pc
		WHERE 1=1
		<if test="category != null and keyword != null and !category.isEmpty() and !keyword.isEmpty()">
            <choose>
                <when test="category == 'number'">
                    AND pc.PRODUCT_CATE_SEQ = #{keyword}
                </when>
                <when test="category == 'category'">
                    AND pc.CATEGORY LIKE '%' || #{keyword} || '%'
                </when>
                <when test="category == 'subCategory'">
                    AND pc.DETAIL_CATEGORY LIKE '%' || #{keyword} || '%'
                </when>
            </choose>
        </if>
	</select>

</mapper>













